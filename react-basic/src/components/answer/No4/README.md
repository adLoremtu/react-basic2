# 問題 4

カウントアップ機能を完成させてみましょう。

## 編集ファイル

- `/src/components/answer/No4/index.tsx（親コンポーネントファイル）`
- `/src/components/ui/countup/props.tsx（子コンポーネントファイル）`

## 機能

- `+`ボタンを押したら数値が 1 ずつカウントアップされる

## カウントアップ処理サンプル（わからない方向け）

```js
// stateの宣言
const [count, setCount] = useState(0);

// 関数名（countUp), 更新関数内の引数(prevCount)は好きに設定していただいてOKです。
// 更新関数名(setCount)はuseStateで宣言した更新関数名を設定してください。
// 第1引数に入っているprevCountは変更前のstateになります。
const countUp = () => {
  setCount((prevCount) => prevCount + 1);
};
```

## 下記の処理だとどうなるのか

- `setCount(count++)`
  - 上記の書き方を実施した場合はエラーとなります。
  - 理由としては`count`というのはあくまで定数であり、変化する値ではないという定義があるためになります。
  - `++`を行うと定数として宣言している`count`に再代入するような挙動となり、変化させてはいけないのに変化させようとしているのでエラーとなるということになります。
  - 言葉での説明は難しいので、ここでは`++`は使えないんだなと思っていただければ OK です。
- `setCount(count + 1)`
  - 上記の書き方を実施した場合は、エラーとはならないですがうまく挙動が動かない場合があります。
  - 例えば下記のように`setTimeout`を使用して 1 秒後に`setCount`を実施するようにし、ボタンを連打してみてください。
  - 複数回連打したはずなのに実際にカウントされる数に差が出ることがわかるかと思います。
  - これは連打実施した時に、現在の state となる`count`を参照しているため更新がかかる前の state に`+1`を行うようにしているためになります。
  - つまり`count = 0`の時に複数回連打したとしても、`count = 0`に`+1`をする処理を複数回行っているということになり、実際のクリック回数と異なるということになります。
  - ここも言葉での説明は難しいので、`count+1`ではうまくいかない時があるんだなくらいに思っていただければ OK です。

```js
const countUp = () => {
  setTimeout(() => {
    setCount(count + 1);
  }, 1000);
};
```

### 参考記事

- [参考記事 - setCount(count++)](https://zenn.dev/kimura141899/articles/4d5817368c4ff6)
- [参考記事 - setCount(count+1)](https://zenn.dev/stin/articles/use-appropriate-api)

## 実装の流れ

### `/src/components/answer/No4/index.tsx（親コンポーネントファイル）`

- `useState`を使用するための事前準備
  - `useState` を使用するためには`import`で機能を読み込むようにする必要があります
  - 書き方としては`import { useState } from "react"`を入れる必要があります
  - 今回すでに`import React from "react"`で react から機能を読み込んでいる処理が存在するので、そこに`useState`も追加で読み込むようにしてみましょう
  - 書き方としては`import React, { useState } from "react"`で読み込むことが可能です
  - ちなみに`{ useState }`という書き方をしていますが、こちらは ES6 の分割代入を使用しています
- state を宣言する
  - 宣言方法としては`[定義するstate, state更新関数] = useState(初期値)`で定義する必要があります。
  - ちなみに`[定義するstate, state更新関数]`という書き方をしていますが、こちらも ES6 の分割代入を使用しています。
- 更新処理を作成する
  - 今回はボタンクリック時に`state更新関数`を実施するような処理を作成する必要があります。
  - なので関数を 1 つ宣言し、その中で`state更新関数`を実施するようにしましょう。
- props でパラメータを渡す
  - No1 で実施したように props でパラメータや関数処理などを渡すことができます。
  - 渡し方は`引数名={渡したい値}`で行うことができます。

### `/src/components/ui/countup/props.tsx（子コンポーネントファイル）`

- 親コンポーネントから送られたパラメータを受け取る
  - 受け取るには JavaScript の引数のように`(props)`と書きます
- props の型を定義
  - 今回 TypeScript を導入しているため、引数の型を明記する必要があります
  - `type Props`の雛形はあるので、その中に props で渡す値と型を書きます
    - No3 を参照に作ってみましょう
  - 型定義が完了した後は`(props: Props)`と書いて適用させれば OK です
    - なお今回カウントアップ処理を渡す予定です。こちらに関しては`() => void`で関数であることを明示することができるのでこちらを使ってみてください。
- 受け取った props を表示させる
  - 表示させるには`{表示させたい値}`と書きます
  - 今回は引数名が`props`となっているので、`{props.表示させたい値}`と書けば OK です
- ボタンをクリックしたときに更新処理が実行されるよう設定する
  - 今回はボタンクリック時に実施したいので、`onClick`を定義してそちらで関数を呼び出すようにしてあげましょう。
  - なお React でイベント処理を実施する場合はいくつかの特徴があります。
    - camelCase を使用する
      - JS では`onclick`と記述しますが、React でイベントを定義する場合は`camelCase`で書く必要があるため`onClick`となります。
    - イベントハンドラとして関数を渡すようにする
      - JS ではイベントハンドラとして文字列を渡す（`<button onclick="hogehoge()">up</button>`）ように記述しますが、React では`関数`を渡すようにする必要があるため`<button onClick={hogehoge}>up</button>`となります。
